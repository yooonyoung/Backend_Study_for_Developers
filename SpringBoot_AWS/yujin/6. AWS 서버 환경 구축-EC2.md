## 서버, 클라우드 서비스란?

### 서비스와 서버

외부에서 서비스에 접근하려면 서버에 배포 필요

서비스를 배포하는 방법 3가지

- PC 24시간 구동
- 호스팅 서비스(카페, 코리아호스팅) 이용
- 클라우드 서비스(AWS, AZURE, GCP 등) 이용

일반적 비용은 호스팅 서비스가 저렴하지만, 

**특정시간에 트래픽일 몰린다면 유동적으로 사양을 늘릴 수 있는 클라우드가 유리**

### 클라우드 서비스

클라우드 서비스는 인터넷을 통해 서버, 스토리지, DB, 네트워크, SW, 모니터링 등의 컴퓨터 서비스를 제공하는 것을 말함

클라우드 서비스 형태 3가지

**Infrastructure as a Service(IaaS, 아이아스, 이에스)**

- 기존 물리 장비 + 미들웨어 함께 묶어둔 추상화 서비스
- 가상머신, 스토리지, 네트워크, 운영체제 등의 `IT 인프라를 대여`해 주는 서비스
- AWS의 EC2, S3 등

**Platform as a Service(PaaS, 파스)**

- IaaS에서 한 번 더 추상화한 서비스
- 한 번 더 추상화했기 때문에 `많은 기능이 자동화`
- AWS의 Beanstalk(빈스톡), Heroku(헤로쿠) 등

**Software as a Service(SaaS, 사스)**

- 소프트웨어 서비스를 이야기
- 구글 드라이브, 드랍박스, 와탭 등

### AWS를 선택한 이유

1. 첫가입시 1년간 대부분 서비스 무료
2. 클라우드에서 기본적으로 지원하는 기능(모니터링, 로그관리, 백업, 복구, 클러스터링 등)이 많아 개인이나 소규모일 때 개발에 좀 더 집중

> 지금 개발하는 AWS 서비스는 모두 IaaS
>
> AWS 빈스톡을 이용하면 작업이 간소화되지만  무중단 배포가 무료가 아니다.



## 1. EC2 서버 생성/접속

#### EC2(Elastic Compute Cloud)

AWS의 성능, 용량 등을 유동적으로 사용할 수 있는 **서버** 

계정 생성 -> 지역 설정 , EC2 -> 인스턴스 생성

### 1) AMI(Amazon Machine Image) 선택

#### AMI(Amazon Machine Image)

가상머신(인스턴스)에서 사용할 수 있게 만든 이미지

**센토스 AMI가 아니라 아마존 리눅스 AMI 선택한 이유는?**

- 아마존이 개발하고 있어서 지원 받기 쉬움
- 레드햇 베이스
- AWS 다른 서비스와 상성 좋음
- 아마존의 독자적 개발 레포지터리를 사용하고 있어 yum이 매우 빠름

### 2) 인스턴스 유형 선택 - t2.micro

**t2는 요금 타입** 을 이야기하며, **micro는 사양**

T시리즈는 크레딧이란 일종의 CPU 사용할 수 있는 포인트 개념이 있다.

인스턴스 크기에 따라 정해진 비율로 CPU 크레딧을 계속 받게 되며, 사용하지 않을 때는 크레딧 축적, 사용할 때 이 크레딧 사용

크레딧을 모두 사용하면 EC2 사용불가

따라서, 트래픽 높은 시리즈는 T시리즈 사용X

### 3) 인스턴스 세부 정보 구성

### 4) 스토리지 추가

프리티어 최대치 30GB

### 5) 태그 추가

태그는 인스턴스 이름

### 6) 보안 그룹 생성

보안그룹 = 방화벽!

**'서버로 80포트 외에는 허용하지 않는다'**는 역하을 하는 방화벽이 AWS에서는 보안 그룹

보안 그룹 규칙에는 인바운드와 아웃바운드가 있는데,

인바운드는 외부 -> AWS 접속할 경우 규칙 지정

인바운드 규칙 

| 유형            | 프로토콜 | 포트 범위 | 소스        |
| --------------- | -------- | --------- | ----------- |
| SSH             | TCP      | 22        | 내 IP       |
| 사용자 지정 TCP | TCP      | 8080      | 사용자 지정 |
| HTTPS           | TCP      | 443       | 사용자 지정 |

 SSH이면서 포트 항목 22인 경우 **AWS EC2에 터미널로 접속**하는 경우다.

pem 키 관리와 **지정된 IP에서만 ssh 접속** 이 가능하도록 구성하는 것이 안전

### 7) 인스턴스 시작 검토

pem키 생성 , 일종의 마스터 키

인스턴스 생성 완료

#### Elastic IP(EIF, 탄력적 IP) 할당

인스턴스도 결국 하나의 서버이므로 IP 존재

인스턴스 생성 시 항상 새 IP 할당, 중지하고 다시 시작하면 IP가 변경됨

**고정된 IP갖기 위해 탄력적 IP 할당**

- 네트워크 및 보안 > 탄력적 IP > 새 주소 할당

고정 IP를 할당 받았으면 **인스턴스와 할당받은 주소의 연결** 필요

- 탄력적 IP > Action > 탄력적 IP 주소 연결

## 2. EC2 서버 접속

윈도우 - PUTTY 이용

## 3. 아마존 리눅스 서버 설정

- **Java 8 설치**
  - 아마존 리눅스 1의 기본 자바 버전은 7,  그리고 현재 이 프로젝트의 버전은 Java 8 
- **타임존 변경**
  - 한국 시간대로 변경
- **호스트네임 변경**
  - 접속한 서버 이름 등록

### 1) **Java 8 설치**

터미널에서 명령어 입력 후 Java 8 설치

~~~
sudo yum install -y java-1.8.0-openjdk-devel.x86_64
~~~

인스턴스의 Java 버전을 8로 변경

~~~
sudo /usr/sbin/alternatives --config java
~~~

Java 7 삭제

~~~
sudo yum remove java-1.7.0-openjdk
~~~

### 2) 타임존 변경

~~~
sudo rm /etc/localtime

sudo ln -s /usr/share/zoneinfo/Asia/Seoul /etc/localtime
~~~

타임존 KST 확인

~~~
date
~~~

### 3) 호스트네임 변경

호스트네임 변경

~~~
sudo vim /etc/sysconfig/network
~~~

> HOSTNAME=호스트네임

서버 재부팅

~~~
sudo reboot
~~~

**호스트 주소를 찾을 때 가장 먼저 검색해 보는 /etc/hosts에 변경한 hostname을 등록**

~~~
sudo vim /etc/hosts
~~~

> 127.0.0.1 호스트네임

